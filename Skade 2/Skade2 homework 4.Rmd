---
title: "Anna's code"
output: html_document
date: "2024-05-07"
---
Library
```{r}
options(scipen = 99)
library(Rcpp)
library(RcppArmadillo)
library(ggplot2)
library(readr)
library(tidyverse)
library(gridExtra)
```

Data
```{r}
claims <- read_csv("claims.csv")
claims<-claims[,c(1,2)]
colnames(claims)<-c("claim_size","deductible")
claims<-mutate(claims,claim_size=claim_size/1000,deductible=deductible/1000)
View(claims)

claims$claim_adjusted<-claims$claim_size - claims$deductible
```

Fit
```{r}
library(fitdistrplus)
#Lognormal
fit_lognormal <- fitdist(claims$claim_size-claims$deductible, "lnorm")
summary(fit_lognormal)

#Weibull
fit_weibull <- fitdist(claims$claim_size-claims$deductible, "weibull")
summary(fit_weibull)

#Pareto
library(actuar)
fit_pareto <- fitdist(claims$claim_size-claims$deductible, "pareto")
summary(fit_pareto)

```

```{r}
exceed_pareto<-function(d){
  alpha<-454.257216
  k<-2.005486
  output<-(k+d)/alpha-1
  return(output)
}

exceed_weibull<-function(d){
  tau<-0.7342342
  c<-364.9229076
  output<- (d^(1-tau))/(c*tau)
  return(output)
}

exceed_lognormal<-function(d){
  sigma_2<-1.164554
  output<- (sigma_2*d)/(log(d)-d)
  return(output)
}

d_values<-c(1:10000)

lognormal_values<-sapply(d_values,exceed_lognormal)
weibull_values<-sapply(d_values,exceed_weibull)
pareto_values<-sapply(d_values,exceed_pareto)
```

Plot
```{r}
plot(d_values, lognormal_values, type = "l", col = "blue", ylim = c(-2, 40), 
     ylab = "E[(X* - d)_+]", xlab = "d", main = "Expected value of (X* - d)_+ for different distributions")
lines(d_values, weibull_values, col = "red")
lines(d_values, pareto_values, col = "green")


legend("topright", legend = c("Lognormal", "Weibull","Pareto"), col = c("blue", "red","green"), lty = 1)
```

